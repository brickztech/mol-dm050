with stocks as (select distinct
        stock_dt as stdate,
        case stock_element_sid
            when 1 then 'MOL'
            when 2 then 'OMV'
            when 3 then 'Orlen'
        end as stname,
        stock_value as stvalue,
        case stock_element_sid
            when 1 then 'USD'
            when 2 then 'EUR'
            when 3 then 'PLN'
        end as stcurrency
    from  [prod_dm050_ds_valuechain_extenv].[t050_04_stock]
),
quotations as (select distinct
        quotation_dt as qdate,
		case quotation_element_sid
			when 35 then 'dated brent'
			when 36 then 'dated brent tons'
			when 29 then 'cif med urals'
			when 30 then 'cif nwe urals'
			when 31 then 'dap india urals'
			when 28 then 'cif med cpc'
			when 27 then 'cif azeri light'
			when 186 then 'ttf day-ahead'
			when 187 then 'ttf month-ahead'
			when 185 then 'cegh vtp da'
			when 94 then 'propane'
			when 93 then 'butane'
			when 95 then 'propane-butane'
			when 154 then 'benzene c'
			when 155 then 'benzene spot'
			when 161 then 'ethylene c'
			when 162 then 'ethylene spot'
			when 172 then 'propylene c'
			when 174 then 'propylene spot'
			when 158 then 'butadiene c'
			when 116 then 'hdpe'
			when 117 then 'ldpe'
			when 119 then 'polypropylene'
		end as qname,
        quote_price as qprice,
        dn_uom as quom
    from [prod_dm050_ds_valuechain_extenv].[t050_01_quotation]
),
spreads as (select distinct
        spread_dt as spdate,
		case spread_element_sid
			when 11 then 'gasoline'
			when 19 then 'gasoline'
			when 6 then 'diesel'
			when 14 then 'diesel'
			when 13 then 'naphta'
			when 21 then 'naphta'
			when 12 then 'jet'
			when 20 then 'jet'
			when 10 then 'gasoil'
			when 18 then 'gasoil'
			when 7 then 'fuel oil 0.5'
			when 15 then 'fuel oil 0.5'
			when 8 then 'fuel oil 1.0'
			when 16 then 'fuel oil 1.0'
			when 9 then 'fuel oil 3.5'
			when 17 then 'fuel oil 3.5'
			when 22 then 'vgo hs'
			when 23 then 'vgo ls'
			when 109 then 'but-naph'
		end as spname,
        spread_value as spvalue,
        dn_uom as spuom
    from [prod_dm050_ds_valuechain_extenv].[t050_02_spread]
),
margins as (select distinct
		margin_dt as mdate,
		case margin_element_sid
			when 10225 then 'c-ref'
			when 10224 then 'c-ref-old'
			when 20212 then 'IEA Med Urals'
			when 30212 then 'IEA Brent'
			when 40217 then
				case
					when margin_dt < '2025-01-01' then 'petchem-old'
					else 'petchem'
				end
			when 40218 then 'petchem-old'
		end as mname,
		margin_value as mvalue,
		margin_company_id as mcompany
	from [prod_dm050_ds_valuechain_extenv].[t050_03_margin]
)
